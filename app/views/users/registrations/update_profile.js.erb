$(".alert").remove();

if (<%= !current_user.errors.any? %>) {

  if (<%= request.env["HTTP_REFERER"].include?("subscribe") %>) {
    // if (<%#= current_user.subscription == "M"  %>) {
      $(".signup-plan").addClass("ishidden");
      $(".signup-payment").addClass("slideup");
      $("#signup-breadcrumb").addClass("slide-3");
    // } else {
    //   window.location.href = "<%#= member_user_dashboard_path(current_user) %>";
    // }
  } else {
    if (<%= current_user.subscription == "M" && !current_user.card_id.present? %>) {
      $("#payment").removeClass('hidden');
      $("#menu a.show-payment").tab('show');
    } else {
     // DISCLAIMER - DISPLAYED
      $(".done-overlay").removeClass("hidden");
      window.setTimeout(function(){
        // DISCLAIMER - HIDDEN
        $(".done-overlay").addClass("hidden");
      }, 3000);
    }
  }
} else {
  if (<%= request.env["HTTP_REFERER"].include?("subscribe") %>) {
    $(document).find(".signup-plan").prepend('<%= j render("components/error_messages", resource: current_user, formats: [:html]) %>');
  } else {
    $(document).find("form").prepend('<%= j render("components/error_messages", resource: current_user, formats: [:html]) %>');
  }
}
