<%= content_for(:title) do %>
  Causes
<% end %>
<%= content_for(:description) do %>
  Découvrez notre liste de causes partenaires
<% end %>

<div class="container-fluid admin">
  <!-- Sub Menu Sidebar -->
  <%= render "member/dashboard/shared/sidebar" %>
  <!-- Content - Statistics -->
  <div class="dashboard dashboard-causes">
    <div class="mobile-menu-overlay hidden"></div>
    <div class="side-menu-overlay hidden"></div>

    <div class="side-menu side-categories">
      <span id="open-categories"><i class="fa fa-cog"></i>Filtrer par catégories</span>
      <ul>
        <a href="#" data-filter="all" class="filter-btn current">
          <li id="categories-all" class="category-item is-selected">
            <div class="container-icon" style="background-color: #fff;">
              <%= image_tag "icons/all.png" %>
            </div>
            Toutes les catégories
          </li>
        </a>
        <% CauseCategory.all.each do |category| %>
        <a href="#" data-filter="<%= "."+category.id.to_s %>" class="filter-btn current">
          <li class="category-item">
            <div class="container-icon" style="background-color: <%= category.color %>;">
              <%= image_tag image_url category.picture %>
            </div>
            <%= category.name %>
          </li>
        </a>
        <% end %>
      </ul>
    </div>

    <div id="mixitup" class="container-perk-cards">
      <% @causes.each do |cause| %>
        <!-- COMPONENT | CARD BON PLAN -->
        <%= link_to asso_cause_path(cause), class: "card-frame mix #{cause.cause_category_id}" do %>
          <!-- CARD HEADER -->
          <div class="card-body" style="background-image: url('<%= image_url cause.picture %>');">
            <div class="disque-item item-category" style="background-color: <%= CauseCategory.find(cause.cause_category_id).color %>;">
              <%= image_tag image_url CauseCategory.find(cause.cause_category_id).picture %>
            </div>
            <span><%= cause.name %></span>
            <p><%= truncate(cause.description, length: 190) %></p>
            <div class="disque-item item-logo">
              <%= image_tag cause.logo %>
            </div>
          </div>
        <% end %>
        <!-- END | CARD BON PLAN -->
      <% end %>
    </div>
  <!-- END | DASHBOARD CAUSES -->
  </div>
 <!-- END | ADMIN -->
</div>


<% content_for :after_js do %>
  <script>
    $(document).ready(function(){
      $('#mixitup').mixItUp({
        load:{
          filter: 'all'
        },
        animation: {
          duration: 300,
          effects: 'fade',
          easing: 'ease'
        },
        selectors: {
          filter: '.filter-btn'
        },
        controls: {
          enable: true
        }
      });

      $('.category-item').click(function(event) {
        if ($(this).val('div').attr('id') != 'categories-all'){
          $('.category-item').removeClass('is-selected'); // TO DELETE FOR MULTIPLE SELECTION
          $('#categories-all').removeClass('is-selected');
          $(this).toggleClass('is-selected');
        } else {
          $('.category-item').removeClass('is-selected');
          $('#categories-all').addClass('is-selected');
        }
      });

      $('#open-categories').click(function(event) {
        $('.side-menu-overlay').toggleClass('hidden');
        //$('.container-perk-cards').toggleClass('blurred');
        $('.side-categories').toggleClass('is-open-max');
        $('.category-item').toggleClass('is-open-min');
        $('.side-notification').removeClass('is-open-max');
        $('.notification-panel').removeClass('is-open-min');
      });
    });
  </script>
<% end %>