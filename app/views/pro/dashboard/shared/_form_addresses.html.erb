<div class="address-overlay hidden">
  <div class="address-container">
    <!-- CLOSE BUTTON -->
    <button type="button" class="close-button"><i class="fa fa-times"></i></button>
    <!-- DAY CARROUSEL -->
    <div class="days-carrousel">
      <% I18n.t(:"date.day_names").each do |day| %>
        <div class="title-address">
          <span class="day"><%= day %></span>
          <div class="form-address" id="<%= day %>">
            <!-- CREATE OR EDIT ADDRESS -->
            <% if current_business.addresses.find_by_day(day) %>
              <% address = current_business.addresses.find_by_day(day) %>
            <% else %>
              <% address = Address.new %>
            <% end %>
            <%= simple_form_for [:pro, current_business, address], remote: true, method: :patch do |f| %>
              <%= f.input :active, as: :boolean, label: 'Adresse active' %>  %>
              <label class="hint--top-right" data-hint="Quel est votre horaire aujourd'hui ?">Horaire</label>
              <%= f.input :start_time_hour, label: "De", collection: pad0(0..23), selected: pad0(f.object.start_time_hour) || '05' %>
              <%= f.input :start_time_min, label: ":", collection: pad0([0, 15, 30, 45]), selected: f.object.start_time_min || 0 %>
              <%= f.input :end_time_hour, label: "Ã ", collection: pad0(0..23), selected: pad0(f.object.end_time_hour) || 14  %>
              <%= f.input :end_time_min, label: ":",collection: pad0([0, 15, 30, 45]), selected: f.object.end_time_min || 0  %>
              <%= f.input :street, placeholder: 'Rue', label: 'Adresse *' %>
              <%= f.input :zipcode, placeholder: 'Code postal', label: 'Code postal *' %>
              <%= f.input :city, placeholder: 'Ville', label: 'Ville *' %>
              <% if address.id.present? %>
                <%= f.button :submit, "Modifier cette adresse", class: "btn-update", disabled: false  %>
              <% else %>
                <%= f.button :submit, "Ajouter cette adresse", class: "btn-new", disabled: true  %>
              <% end %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<%= render 'pro/dashboard/shared/updated' %>

<% content_for :after_js do %>
  <script>
    $(document).ready(function() {

      // CLOSE ADDRESS OVERLAY
      $('.close-button').click(function() {
        $('.address-overlay').addClass('hidden');
      });

      // CONTROL REQUIRED FIELDS
      $(".form-address").on("change", function(e) {
        e.preventDefault();
        var dayName = $(this).attr('id');
        if ($('#'+dayName).find('#address_street').val() != "" &&
            $('#'+dayName).find('#address_zipcode').val() != "" &&
            $('#'+dayName).find('#address_city').val() != "" ) {
          $('#'+dayName).find('.btn').attr('disabled', false);
        } else {
        $('#'+dayName).find('.btn').attr('disabled', true);
        }
      });

      // ACTIVE/DESACTIVE ADDRESS
      $(':checkbox').change(function() {
        var updateAddress = "update_address_" + ($(this).val("form").attr('id'))
        $('#' + updateAddress).submit();
      });

    });
  </script>
<% end %>
