<!-- FORM SELECT CAUSE -->
<div class="choose-cause">

  <div class="user-support">
    <div class="picture-container">
      <% if current_user.picture? %>
        <%= image_tag current_user.picture.url(:thumb), class: 'user-picture' %>
      <% else %>
        <div class="picture-none">
          <%= render 'shared/icons/profile' %>
        </div>
      <% end %>
    </div>
    <div class="picture-container">
      <% if current_user.cause_id.present? %>
        <%= image_tag Cause.find(current_user.cause_id).logo.url(:thumb), class: 'user-picture' %>
      <% else %>
        <div class="picture-none">
          <%= render 'shared/icons/profile' %>
        </div>
      <% end %>
    </div>
    <% if current_user.cause_id.present? %>
      Vous soutenez actuellement <%= Cause.find(current_user.cause_id).name %>.
    <% end %>
  </div>

  <div class="causes-carrousel">
    <!-- Random Causes cards -->
    <% Cause.all.each do |cause| %>
      <%= link_to member_update_cause_path(cause_id: cause.id), method: :put, remote: true, authenticity_token: true do %>
        <!-- COMPONENT | CARD CAUSE -->
        <div class="card-cause" style="background-image: url('<%= image_url cause.picture %>');">
          <div class="disque-item item-category" style="background-color: <%= CauseCategory.find(cause.cause_category_id).color %>;">
            <%= image_tag image_url CauseCategory.find(cause.cause_category_id).picture %>
          </div>
          <span><%= cause.name %></span>
          <p><%= truncate(cause.description, length: 190) %></p>
          <div class="disque-item item-logo">
            <%= image_tag cause.logo %>
          </div>
        </div>
        <!-- END | CARD CAUSE -->
      <% end %>
    <% end %>
  </div>
</div>

<% content_for :after_js do %>

  <script>
    $(document).ready(function() {
      $(".cause-card").on("click", function(e) {
        e.preventDefault;
        var causeId = $(this).val('div').attr('id');
        $(".cause-overlay").toggleClass("cause-overlay");
        $($(this).toggleClass("cause-overlay"));
        $("select").val(causeId);
      });

      $(".cause-popover").popover({
        html: true,
        container: "body",
        trigger: "hover"
      });
    });
  </script>

<% end %>
