<!-- FORM SELECT CAUSE SIGNUP -->
<div class="signup-cause">
  <div class="choose-cause  ">
    <div class="change-cause">
      <span>Choississez votre cause</span>
        <div class="causes-carrousel">
        <!-- Random Causes cards -->
        <% Cause.all.each do |cause| %>
          <% if cause.id != current_user.cause_id && cause.id != ENV['CAUSE_ID_CFORGOOD'].to_i %>
            <div id="<%= cause.id %>" class="cause-presentation">
              <!-- CARD CAUSE -->
              <%= render(partial: 'components/card_cause', locals: { cause: cause }) %>
            </div>
          <% end %>
        <% end %>
      </div>
      <%= simple_form_for(current_user, url: member_update_cause_path, remote: true, authenticity_token: true, html: { method: :put, id: :update_cause_id }) do |f| %>
      <%= f.input :cause_id, as: :hidden %>
      <%= f.submit "Soutenir cette cause", class: "user-button" %>
      <% end %>
    </div>
  </div>
  <button class="user-button-next">Continuer</button>
</div>

<% content_for :after_js do %>

  <script>
    $(document).ready(function() {

      $(".user-button").on("click", function(e) {
        e.preventDefault;
        var causeId = $('.cause-presentation.slick-active').val('div').attr('id');
        $(".popup-overlay").toggleClass("hidden");
        $("#user_cause_id").val(causeId);
        var causeName = $('.cause-presentation.slick-active .card-cause span').html();
        $('.cause-confirmation span.cause-name').html(causeName);
      });

      $(".user-button-next").on("click", function(e) {
        e.preventDefault;
        $(".choose-cause").addClass("ishidden");
        $(".signup-plan").addClass("slideup");
        $("#signup-breadcrumb").addClass("slide-2");
      });
    });
  </script>

<% end %>
