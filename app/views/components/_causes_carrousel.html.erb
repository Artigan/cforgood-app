<!-- CAUSES CARROUSEL -->
<div class="change-cause">
  <span class="tab-subtitle">DÃ©couvrir d'autres causes</span>
  <div class="causes-carrousel">
    <!-- Random Causes cards -->
    <% Cause.all.each do |cause| %>
      <% if cause.id != current_user.cause_id && cause.id != ENV['CAUSE_ID_CFORGOOD'].to_i %>
        <!-- COMPONENT | CARD CAUSE -->
        <div id="<%= cause.id %>" class="cause-presentation">
          <%= link_to asso_cause_path(cause), class: "card-frame" do %>
            <div class="card-cause" style="background-image: url('<%= image_url cause.picture %>');">
              <div class="disque-item item-category" style="background-color: <%= cause.cause_category.color %>;">
                <%= image_tag image_url cause.cause_category.picture %>
              </div>
              <span><%= cause.name %></span>
              <p><%= truncate(cause.description, length: 190) %></p>
              <div class="disque-item item-logo">
                <%= image_tag cause.logo %>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    <% end %>
  </div>
  <button class="user-button">Soutenir cette cause</button>
</div>

<%= render 'components/popups/cause_validation' %>


<% content_for :after_js do %>
  <script>
    $(document).ready(function() {
      $(".user-button").on("click", function(e) {
        e.preventDefault;
        var causeId = $('.cause-presentation.slick-active').val('div').attr('id');
        var causeName = $('.cause-presentation.slick-active .card-cause span').html();
        $(".popup-overlay").toggleClass("hidden");
        $("#user_cause_id").val(causeId);
        $('.cause-confirmation span.cause-name').html(causeName);
      });
    });
  </script>
<% end %>
