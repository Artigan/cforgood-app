<div class="signup-payment">
  <div class="payment-container">
    <span>Renseignez vos données bancaires</span>
    <div class="payment-title">
      <span class="text-subscription">Montant de la participation choisi : </span>
      <span id="amount_subscription"><%= current_user.amount if !request.path.include?("gift") %></span> /
      <span id="label_subscription"><%= current_user.subscription == "Y" ? "an" : "mois" if !request.path.include?("gift") %></span>
    </div>
    <% if request.path.include?("gift") %>
      <span class="message-subscription">Le paiement sera effectué le 15 janvier !</span>
    <% end %>
    <span class="message-subscription hidden">Rassurez-vous ! <br> Le prélèvement se fera dans <span class="days"></span> jours.</span>

    <%= form_tag member_subscribe_index_path(current_user), id: "payment-form" do %>
        <div class="form-row">
          <div id="card-element">
            <!-- a Stripe Element will be inserted here. -->
          </div>

          <!-- Used to display form errors -->
          <div id="card-errors" role="alert"></div>
        </div>

        <button class="btn-submit">Valider</button>
    <% end %>

    <%= link_to "Je renseignerai plus tard mes données bancaires ", member_user_dashboard_path(current_user), class: "btn btn-no-bank-details" %>
    <button class="signup-prev">Retour</button>
    <div class="hidden">
        <%= simple_form_for :rollback_code_partner, url: member_subscribe_path(current_user), remote: true, method: :delete do |f| %>
        <%= f.submit "", class: "rollback_code_partner", :style => "display: none;" %>
        <% end %>
      </div>
  </div>
</div>
<div>
  <%= image_tag('icons/loading.gif', id: "loading-indicator", style: "display: none;") %>
</div>

<!-- MODAL MESSAGE INFORMATION -->
<%= render "components/modals/payment" %>

<% content_for :after_js do %>

  <script>
    <% if request.path.include?("gift") %>
      $('#amount_subscription').html($('#beneficiary_amount').val());
      $('#label_subscription').html("(" + $('#beneficiary_nb_month').val() + " mois)");
    <% end %>
  </script>

  <%= render "components/js/payment" %>

<% end %>
