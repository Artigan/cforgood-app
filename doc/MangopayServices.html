<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: MangopayServices
  
    &mdash; Documentation by YARD 0.9.9
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "MangopayServices";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (M)</a> &raquo;
    
    
    <span class="title">MangopayServices</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: MangopayServices
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">MangopayServices</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="Modules/ModulePayment.html" title="Modules::ModulePayment (module)">Modules::ModulePayment</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/services/mangopay_services.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_bankwire_payin-instance_method" title="#create_mangopay_bankwire_payin (instance method)">#<strong>create_mangopay_bankwire_payin</strong>(wallet_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_card_pre_registration-instance_method" title="#create_mangopay_card_pre_registration (instance method)">#<strong>create_mangopay_card_pre_registration</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_iban_bankaccount-instance_method" title="#create_mangopay_iban_bankaccount (instance method)">#<strong>create_mangopay_iban_bankaccount</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_legal_user-instance_method" title="#create_mangopay_legal_user (instance method)">#<strong>create_mangopay_legal_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_mandate-instance_method" title="#create_mangopay_mandate (instance method)">#<strong>create_mangopay_mandate</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_natural_user-instance_method" title="#create_mangopay_natural_user (instance method)">#<strong>create_mangopay_natural_user</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_payin-instance_method" title="#create_mangopay_payin (instance method)">#<strong>create_mangopay_payin</strong>(wallet_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_mangopay_wallet-instance_method" title="#create_mangopay_wallet (instance method)">#<strong>create_mangopay_wallet</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(current_user)  &#x21d2; MangopayServices </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of MangopayServices.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Modules/ModulePayment.html" title="Modules::ModulePayment (module)">Modules::ModulePayment</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Modules/ModulePayment.html#change_connected_account-instance_method" title="Modules::ModulePayment#change_connected_account (method)">#change_connected_account</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#create_or_update_payment-instance_method" title="Modules::ModulePayment#create_or_update_payment (method)">#create_or_update_payment</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#manage_error-instance_method" title="Modules::ModulePayment#manage_error (method)">#manage_error</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#set_debited_funds-instance_method" title="Modules::ModulePayment#set_debited_funds (method)">#set_debited_funds</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#set_donation-instance_method" title="Modules::ModulePayment#set_donation (method)">#set_donation</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#set_fees-instance_method" title="Modules::ModulePayment#set_fees (method)">#set_fees</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#set_percent_cause-instance_method" title="Modules::ModulePayment#set_percent_cause (method)">#set_percent_cause</a></span>, <span class='object_link'><a href="Modules/ModulePayment.html#set_plan_id-instance_method" title="Modules::ModulePayment#set_plan_id (method)">#set_plan_id</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(current_user)  &#x21d2; <tt><span class='object_link'><a href="" title="MangopayServices (class)">MangopayServices</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of MangopayServices</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


5
6
7</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 5</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_current_user'>current_user</span><span class='rparen'>)</span>
    <span class='ivar'>@user</span> <span class='op'>=</span> <span class='id identifier rubyid_current_user'>current_user</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="create_mangopay_bankwire_payin-instance_method">
  
    #<strong>create_mangopay_bankwire_payin</strong>(wallet_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_bankwire_payin'>create_mangopay_bankwire_payin</span><span class='lparen'>(</span><span class='id identifier rubyid_wallet_id'>wallet_id</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>5</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>50</span><span class='op'>-</span><span class='int'>30</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>5.0</span><span class='op'>-</span><span class='float'>1.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>30</span><span class='semicolon'>;</span>
  <span class='kw'>elsif</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>10</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>70</span><span class='op'>-</span><span class='int'>50</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>5</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>10.0</span><span class='op'>-</span><span class='float'>5.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>50</span><span class='semicolon'>;</span>
  <span class='kw'>elsif</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>15</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>75</span><span class='op'>-</span><span class='int'>70</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>10</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>15.0</span><span class='op'>-</span><span class='float'>10.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>70</span><span class='semicolon'>;</span>
  <span class='kw'>elsif</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>20</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='float'>77.5</span><span class='op'>-</span><span class='int'>75</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>15</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>20.0</span><span class='op'>-</span><span class='float'>15.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>75</span><span class='semicolon'>;</span>
  <span class='kw'>elsif</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>25</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>80</span><span class='op'>-</span><span class='float'>77.5</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>20</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>25.0</span><span class='op'>-</span><span class='float'>20.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='float'>77.5</span><span class='semicolon'>;</span>
  <span class='kw'>elsif</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span> <span class='op'>&lt;=</span> <span class='int'>50</span>
    <span class='id identifier rubyid_percent_cause'>percent_cause</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='int'>85</span><span class='op'>-</span><span class='int'>80</span><span class='rparen'>)</span><span class='op'>*</span><span class='lparen'>(</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>-</span><span class='int'>25</span><span class='rparen'>)</span><span class='op'>/</span><span class='lparen'>(</span><span class='float'>50.0</span><span class='op'>-</span><span class='float'>25.0</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='op'>+</span><span class='int'>80</span><span class='rparen'>)</span><span class='semicolon'>;</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='op'>=</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>*</span><span class='int'>100</span>
  <span class='id identifier rubyid_credited_funds'>credited_funds</span> <span class='op'>=</span>  <span class='id identifier rubyid_debited_funds'>debited_funds</span><span class='op'>*</span><span class='id identifier rubyid_percent_cause'>percent_cause</span><span class='op'>/</span><span class='int'>100</span>
  <span class='id identifier rubyid_fees'>fees</span> <span class='op'>=</span> <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='op'>-</span> <span class='id identifier rubyid_credited_funds'>credited_funds</span>

  <span class='id identifier rubyid_payin_info'>payin_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>AuthorId:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_id'>mangopay_id</span><span class='comma'>,</span>
    <span class='label'>DeclaredDebitedFunds:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>CreditedFunds:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_credited_funds'>credited_funds</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>DeclaredFees:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_fees'>fees</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>CreditedWalletId:</span> <span class='id identifier rubyid_wallet_id'>wallet_id</span><span class='comma'>,</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_payin_bankwire_direct'>mangopay_payin_bankwire_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_payin_info'>payin_info</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_card_pre_registration-instance_method">
  
    #<strong>create_mangopay_card_pre_registration</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


24
25
26
27
28
29
30
31
32</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 24</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_card_pre_registration'>create_mangopay_card_pre_registration</span>
  <span class='id identifier rubyid_card_registration_info'>card_registration_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>UserId:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_id'>mangopay_id</span><span class='comma'>,</span>
    <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>CardType:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CB_VISA_MASTERCARD</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_card_registration_create'>mangopay_card_registration_create</span><span class='lparen'>(</span><span class='id identifier rubyid_card_registration_info'>card_registration_info</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_iban_bankaccount-instance_method">
  
    #<strong>create_mangopay_iban_bankaccount</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 81</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_iban_bankaccount'>create_mangopay_iban_bankaccount</span>
  <span class='id identifier rubyid_bankwire_info'>bankwire_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>Type:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IBAN</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>OwnerName:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
    <span class='label'>OwnerAddress:</span> <span class='lbrace'>{</span>
      <span class='label'>AddressLine1:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_street'>street</span><span class='comma'>,</span>
      <span class='label'>City:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_city'>city</span><span class='comma'>,</span>
      <span class='label'>PostalCode:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_zipcode'>zipcode</span><span class='comma'>,</span>
      <span class='label'>Country:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>IBAN:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR3020041010124530725S03383</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>BIC:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CRLYFRPP</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_iban_bankaccount_create'>mangopay_iban_bankaccount_create</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_id'>mangopay_id</span><span class='comma'>,</span> <span class='id identifier rubyid_bankwire_info'>bankwire_info</span><span class='rparen'>)</span>

  <span class='comment'># @mangopay_user = MangopayServices.new(User.first).create_mangopay_iban_bankaccount
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_legal_user-instance_method">
  
    #<strong>create_mangopay_legal_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_legal_user'>create_mangopay_legal_user</span>
  <span class='id identifier rubyid_legal_user_info'>legal_user_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>Name:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span>
    <span class='label'>Email:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span><span class='comma'>,</span>
    <span class='label'>LegalPersonType:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BUSINESS</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>LegalRepresentativeFirstName:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_representative_first_name'>representative_first_name</span><span class='comma'>,</span>
    <span class='label'>LegalRepresentativeLastName:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_representative_last_name'>representative_last_name</span><span class='comma'>,</span>
    <span class='label'>LegalRepresentativeBirthday:</span> <span class='int'>0</span><span class='comma'>,</span>
    <span class='label'>LegalRepresentativeNationality:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
    <span class='label'>LegalRepresentativeCountryOfResidence:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_legal_user_create'>mangopay_legal_user_create</span><span class='lparen'>(</span><span class='id identifier rubyid_legal_user_info'>legal_user_info</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_mandate-instance_method">
  
    #<strong>create_mangopay_mandate</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102
103
104
105
106
107
108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_mandate'>create_mangopay_mandate</span>
  <span class='id identifier rubyid_mandate_info'>mandate_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>BankAccountId:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>16618384</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>Culture:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>ReturnURL:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://www.cforgood.com</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_mandate_create'>mangopay_mandate_create</span><span class='lparen'>(</span><span class='id identifier rubyid_mandate_info'>mandate_info</span><span class='rparen'>)</span>

  <span class='comment'># result = MangopayServices.new(User.first).create_mangopay_mandate
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_natural_user-instance_method">
  
    #<strong>create_mangopay_natural_user</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 9</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_natural_user'>create_mangopay_natural_user</span>
  <span class='id identifier rubyid_user_info'>user_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FirstName</span><span class='label_end'>&quot;:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_first_name'>first_name</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>LastName</span><span class='label_end'>&quot;:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_last_name'>last_name</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Birthday</span><span class='label_end'>&quot;:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_birthday'>birthday</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nationality</span><span class='label_end'>&quot;:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='comment'># &quot;Nationality&quot;: self.nationality,
</span>    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CountryOfResidence</span><span class='label_end'>&quot;:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FR</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>PersonType</span><span class='label_end'>&quot;:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>NATURAL</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Email</span><span class='label_end'>&quot;:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_email'>email</span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_user'>mangopay_user</span> <span class='op'>=</span> <span class='id identifier rubyid_mangopay_natural_user_create'>mangopay_natural_user_create</span><span class='lparen'>(</span><span class='id identifier rubyid_user_info'>user_info</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_payin-instance_method">
  
    #<strong>create_mangopay_payin</strong>(wallet_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 34</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_payin'>create_mangopay_payin</span><span class='lparen'>(</span><span class='id identifier rubyid_wallet_id'>wallet_id</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='op'>=</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='op'>*</span><span class='int'>100</span>
  <span class='id identifier rubyid_credited_funds'>credited_funds</span> <span class='op'>=</span>  <span class='id identifier rubyid_set_donation'>set_donation</span><span class='lparen'>(</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_amount'>amount</span><span class='comma'>,</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span><span class='rparen'>)</span><span class='op'>*</span><span class='int'>100</span>
  <span class='id identifier rubyid_fees'>fees</span> <span class='op'>=</span> <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='op'>-</span> <span class='id identifier rubyid_credited_funds'>credited_funds</span>

  <span class='id identifier rubyid_payin_info'>payin_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>AuthorId:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_id'>mangopay_id</span><span class='comma'>,</span>
    <span class='label'>DebitedFunds:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_debited_funds'>debited_funds</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>CreditedFunds:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_credited_funds'>credited_funds</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>Fees:</span> <span class='lbrace'>{</span> <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>Amount:</span> <span class='id identifier rubyid_fees'>fees</span> <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='label'>CreditedWalletId:</span> <span class='id identifier rubyid_wallet_id'>wallet_id</span><span class='comma'>,</span>
    <span class='label'>CardId:</span> <span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_card_id'>mangopay_card_id</span><span class='comma'>,</span>
    <span class='label'>SecureMode:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DEFAULT</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>SecureModeReturnURL:</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>https://www.cforgood.com</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>StatementDescriptor:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CFORGOOD</span><span class='tstring_end'>&quot;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_payin_card_direct'>mangopay_payin_card_direct</span><span class='lparen'>(</span><span class='id identifier rubyid_payin_info'>payin_info</span><span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_mangopay_wallet-instance_method">
  
    #<strong>create_mangopay_wallet</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73
74
75
76
77
78
79</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/services/mangopay_services.rb', line 71</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_mangopay_wallet'>create_mangopay_wallet</span>
  <span class='id identifier rubyid_wallet_info'>wallet_info</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='label'>Owners:</span> <span class='lbracket'>[</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_mangopay_id'>mangopay_id</span><span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='label'>Description:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Portefeuille de </span><span class='embexpr_beg'>#{</span><span class='ivar'>@user</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
    <span class='label'>Currency:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EUR</span><span class='tstring_end'>&#39;</span></span>
  <span class='rbrace'>}</span>

  <span class='id identifier rubyid_mangopay_wallet_create'>mangopay_wallet_create</span><span class='lparen'>(</span><span class='id identifier rubyid_wallet_info'>wallet_info</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Oct 30 21:57:29 2017 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.9 (ruby-2.3.1).
</div>

    </div>
  </body>
</html>